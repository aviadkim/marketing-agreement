<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>הסכם שיווק השקעות - מובנה</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        :root {
            --movne-blue: #0055FF;
            --movne-dark: #1E2841;
            --movne-gray: #F3F4F6;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        .form-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 2px solid var(--movne-gray);
        }

        .card-checkbox input, .card-radio input {
            display: none;
        }

        .card-checkbox div, .card-radio div {
            transition: all 0.3s ease;
        }

        .card-checkbox input:checked + div, .card-radio input:checked + div {
            border-color: var(--movne-blue);
            background-color: #EBF5FF;
        }

        .signature-pad {
            border: 2px dashed var(--movne-gray);
            border-radius: 8px;
            background: white;
        }

        .accordion-button {
            padding: 1rem;
            width: 100%;
            text-align: right;
            background: var(--movne-gray);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.3s;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding: 0 1rem;
        }

        .accordion-content.open {
            max-height: 1000px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Logo Header -->
        <div class="text-center mb-8">
            <img src="/images/movne-logo.png" alt="מובנה" class="h-24 mx-auto mb-4">
            <h1 class="text-3xl font-bold text-gray-900">הסכם שיווק השקעות</h1>
            <div class="text-lg text-gray-600" id="currentDate"></div>
        </div>

        <!-- Multi-Step Form -->
        <form id="marketingAgreement">
            <!-- Progress Bar -->
            <div class="relative pt-1 mb-8">
                <div class="flex mb-2 items-center justify-between">
                    <div class="text-right">
                        <span class="text-xs font-semibold inline-block text-blue-600" id="progressText">
                            שלב 1 מתוך 4
                        </span>
                    </div>
                </div>
                <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                    <div id="progressBar" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500" style="width: 25%"></div>
                </div>
            </div>

            <!-- Step 1: Personal Details -->
            <div class="step active" id="step1">
                <div class="form-section">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">פרטי לקוח</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">שם מלא</label>
                            <input type="text" name="fullName" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">מספר זיהוי</label>
                            <input type="text" name="idNumber" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">דואר אלקטרוני</label>
                            <input type="email" name="email" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">כתובת</label>
                            <input type="text" name="address" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">מספר טלפון</label>
                            <input type="tel" name="phone" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Investment Details -->
            <div class="step" id="step2">
                <div class="form-section">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">פרטי השקעה</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">סכום מתוכנן להשקעה במוצרים מובנים</label>
                            <input type="number" name="investmentAmount" required 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="input-group">
                            <label class="block text-gray-700 font-medium mb-2">בנק</label>
                            <select name="bank" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">בחר/י בנק...</option>
                                <option value="poalim">הפועלים</option>
                                <option value="leumi">לאומי</option>
                                <option value="discount">דיסקונט</option>
                                <option value="mizrahi">מזרחי טפחות</option>
                                <option value="firstInt">הבינלאומי</option>
                            </select>
                        </div>
                    </div>

                    <!-- Currency Section -->
                    <div class="mt-8">
                        <label class="block text-gray-700 font-medium mb-4">מטבע יחוס</label>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <label class="card-checkbox">
                                <input type="checkbox" name="currency" value="ILS">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">שקל</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="currency" value="USD">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">דולר</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="currency" value="EUR">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">יורו</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="currency" value="GBP">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">ליש"ט</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Investment Purpose -->
                    <div class="mt-8">
                        <label class="block text-gray-700 font-medium mb-4">ייעוד הכסף (ניתן לבחור יותר מתשובה אחת)</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="card-checkbox">
                                <input type="checkbox" name="purpose" value="property">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">רכישת נכס</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="purpose" value="pension">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">פנסיה</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="purpose" value="familySupport">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">סיוע למשפחה</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="purpose" value="investment">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">השקעה</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Risk Assessment -->
            <div class="step" id="step3">
                <div class="form-section">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">הערכת סיכון</h2>
                    
                    <!-- Investment Timeline -->
                    <div class="mb-8">
                        <label class="block text-gray-700 font-medium mb-4">טווח ההשקעה הצפוי</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="card-radio">
                                <input type="radio" name="timeline" value="upTo2" required>
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">עד שנתיים</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="timeline" value="2to5">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">שנתיים עד חמש שנים</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="timeline" value="over5">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">מעל חמש שנים</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="timeline" value="unlimited">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">לא מוגבל בזמן</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Market Experience -->
                    <div class="mb-8">
                        <label class="block text-gray-700 font-medium mb-4">רמת הידע והניסיון בשוק ההון</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="card-checkbox">
                                <input type="checkbox" name="marketExperience" value="none">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">אין ניסיון</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="marketExperience" value="studies">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">במסגרת לימודים</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="marketExperience" value="over5years">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">משקיע בשוק ההון מעל 5 שנים</span>
                                </div>
                            </label>
                            <label class="card-checkbox">
                                <input type="checkbox" name="marketExperience" value="structured">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">השקעתי במוצרים מובנים</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Crisis Behavior -->
                    <div class="mb-8">
                        <label class="block text-gray-700 font-medium mb-4">התנהגות במשברים קודמים</label>
                        <div class="space-y-4">
                            <label class="card-radio">
                                <input type="radio" name="crisisBehavior" value="sold_all" required>
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">מכרתי את כל התיק ועברתי למזומן</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="crisisBehavior" value="reduced">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">הקטנתי משמעותית את החשיפה למניות</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="crisisBehavior" value="no_change">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">לא ביצעתי שום שינוי כי ההשקעות שלי הן לטווח ארוך</span>
                                </div>
                            </label>
                            <label class="card-radio">
                                <input type="radio" name="crisisBehavior" value="opportunity">
                                <div class="p-4 border rounded-lg hover:bg-gray-50">
                                    <span class="font-medium">ניצלתי את ההזדמנות והגדלתי את החשיפה</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
 
            <!-- Step 4: Legal Text & Signature -->
            <div class="step" id="step4">
                <div class="form-section">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">הצהרות וחתימה</h2>
 
                    <!-- Legal Text Accordion -->
                    <div class="space-y-4 mb-8">
                        <div class="border rounded-lg">
                            <button type="button" class="accordion-button w-full p-4 flex justify-between items-center">
                                <span class="font-medium">מבוא ופרשנות</span>
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div class="accordion-content">
                                <div class="p-4 text-gray-600">
                                    הואיל והחברה בעלת רישיון שיווק השקעות כמשמעות מונח זה בחוק הסדרת העיסוק בייעוץ השקעות...
                                </div>
                            </div>
                        </div>
                    </div>
 
                    <!-- Signature Section -->
                    <div class="signature-section bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-medium mb-4">חתימה דיגיטלית</h3>
                        <canvas id="signatureCanvas" class="w-full h-48 bg-white border-2 border-gray-300 rounded-lg mb-4"></canvas>
                        <div class="flex justify-between">
                            <button type="button" id="clearSignature" class="px-4 py-2 text-gray-600 bg-gray-100 rounded hover:bg-gray-200">
                                נקה חתימה
                            </button>
                            <div class="relative">
                                <input type="file" id="signatureFile" accept="image/*" class="hidden">
                                <label for="signatureFile" class="px-4 py-2 bg-blue-500 text-white rounded cursor-pointer hover:bg-blue-600">
                                    העלה קובץ חתימה
                                </label>
                            </div>
                        </div>
                    </div>
 
                    <!-- Final Declarations -->
                    <div class="mt-8 space-y-4">
                        <label class="flex items-center">
                            <input type="checkbox" required class="h-4 w-4 text-blue-600">
                            <span class="mr-2 text-sm">קראתי והבנתי את כל תנאי ההסכם</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" required class="h-4 w-4 text-blue-600">
                            <span class="mr-2 text-sm">אני מסכים/ה לכל התנאים המפורטים</span>
                        </label>
                    </div>
                </div>
            </div>
 
            <!-- Navigation Buttons -->
            <div class="flex justify-between mt-8">
                <button type="button" id="prevBtn" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300" style="display: none">
                    הקודם
                </button>
                <button type="button" id="nextBtn" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                    הבא
                </button>
                <button type="submit" id="submitBtn" class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600" style="display: none">
                    שלח טופס
                </button>
            </div>
        </form>
    </div>
 
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.5/dist/signature_pad.min.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 4;
        let signaturePad;
 
        document.addEventListener('DOMContentLoaded', function() {
            initializeForm();
        });
 
        function initializeForm() {
            initializeSignaturePad();
            setCurrentDate();
            initializeAccordions();
            setupNavigationButtons();
        }
 
        function initializeSignaturePad() {
            const canvas = document.getElementById('signatureCanvas');
            if (canvas) {
                signaturePad = new SignaturePad(canvas, {
                    minWidth: 1,
                    maxWidth: 2.5,
                    backgroundColor: 'rgb(255, 255, 255)'
                });
 
                document.getElementById('clearSignature')?.addEventListener('click', () => {
                    signaturePad.clear();
                });
            }
        }
 
        function setCurrentDate() {
            const now = new Date();
            const hebrewMonths = ['ינואר', 'פברואר', 'מרץ', 'אפריל', 'מאי', 'יוני',
                                'יולי', 'אוגוסט', 'ספטמבר', 'אוקטובר', 'נובמבר', 'דצמבר'];
            
            const dateStr = `נערך ונחתם ביום ${now.getDate()} לחודש ${hebrewMonths[now.getMonth()]} שנת ${now.getFullYear()}`;
            document.getElementById('currentDate').textContent = dateStr;
        }
 
        function initializeAccordions() {
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    content.classList.toggle('open');
                });
            });
        }
 
        function setupNavigationButtons() {
            const nextBtn = document.getElementById('nextBtn');
            const prevBtn = document.getElementById('prevBtn');
            const submitBtn = document.getElementById('submitBtn');
 
            nextBtn?.addEventListener('click', () => {
                if (validateStep(currentStep)) {
                    moveToStep(currentStep + 1);
                }
            });
 
            prevBtn?.addEventListener('click', () => {
                moveToStep(currentStep - 1);
            });
 
            document.getElementById('marketingAgreement')?.addEventListener('submit', handleSubmit);
        }
 
        function moveToStep(step) {
            document.querySelector(`#step${currentStep}`)?.classList.remove('active');
            currentStep = step;
            document.querySelector(`#step${currentStep}`)?.classList.add('active');
            
            updateNavigationButtons();
            updateProgressBar();
        }
 
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');
 
            if (prevBtn) prevBtn.style.display = currentStep === 1 ? 'none' : 'block';
            if (nextBtn) nextBtn.style.display = currentStep === totalSteps ? 'none' : 'block';
            if (submitBtn) submitBtn.style.display = currentStep === totalSteps ? 'block' : 'none';
        }
 
        function updateProgressBar() {
            const progress = (currentStep / totalSteps) * 100;
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
 
            if (progressBar) progressBar.style.width = `${progress}%`;
            if (progressText) progressText.textContent = `שלב ${currentStep} מתוך ${totalSteps}`;
        }
 
        function validateStep(step) {
            // Add validation logic here
            return true;
        }
 
        async function handleSubmit(e) {
            e.preventDefault();
            
            if (!validateStep(currentStep)) return;
 
            const submitBtn = document.getElementById('submitBtn');
            if (submitBtn) submitBtn.disabled = true;
 
            try {
                const formData = new FormData(e.target);
                if (signaturePad) {
                    formData.append('signature', signaturePad.toDataURL());
                }
 
                const response = await submitForm(formData);
                if (response.ok) {
                    showMessage('הטופס נשלח בהצלחה', 'success');
                    setTimeout(() => {
                        window.location.href = '/thanks.html';
                    }, 2000);
                } else {
                    throw new Error('שגיאה בשליחת הטופס');
                }
            } catch (error) {
                showMessage(error.message, 'error');
                if (submitBtn) submitBtn.disabled = false;
            }
        }
 
        function showMessage(message, type) {
            // Add message display logic here
        }
 
        async function submitForm(formData) {
            // Add form submission logic here
            return { ok: true };
        }
    </script>
 </body>
 </html>